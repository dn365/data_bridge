output:
  - influxdb:
    host: 10.70.181.211
    username: root
    password: 1qaz2wsx
    database: test_data

input:
  - series_name: cb_process_perf.1d
    desc: "计费分析批价性能"
    cron: "0 * * * *"
    runtime:
      interval: 86400
      update: true
      output_timestamp: "start:%Y%m%d"
    hosts:
      - adapter: oracle
        host: zjcba2.yw.zj.chinamobile.com
        port: 1521
        username: hp_dbspi
        password: hp_dbspi123
        database: zjcb2
        default_options:
          $begin: "%Y%m%d"
          $end: "%Y%m%d"
        sql_group:
          - sql: "select a.a_filter_sum a_filter_sum, a.a_filter_speed a_filter_speed, b.b_filter_sum b_filter_sum, b.b_filter_speed b_filter_speed, c.c_filter_sum c_filter_sum, c.c_filter_speed c_filter_speed, d.d_filter_sum d_filter_sum, d.d_filter_speed d_filter_speed, a1.a_rating_sum a_rating_sum, a1.a_rating_speed a_rating_speed, b1.b_rating_sum b_rating_sum, b1.b_rating_speed b_rating_speed, c1.c_rating_sum c_rating_sum, c1.c_rating_speed c_rating_speed, d1.d_rating_sum d_rating_sum, d1.d_rating_speed d_rating_speed from (SELECT sum(in_sum) a_filter_sum, round(avg(speed)) a_filter_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'filter'and SERVICE = 'gprs'and centre = 'A'group by substr(process_time, 1, 8)) a, (SELECT sum(in_sum) b_filter_sum, round(avg(speed)) b_filter_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'filter'and SERVICE = 'gprs'and centre = 'B'group by substr(process_time, 1, 8)) b, (SELECT sum(in_sum) c_filter_sum, round(avg(speed)) c_filter_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'filter'and SERVICE = 'gprs'and centre = 'C'group by substr(process_time, 1, 8)) c, (SELECT sum(in_sum) d_filter_sum, round(avg(speed)) d_filter_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'filter'and SERVICE = 'gprs'and centre = 'D'group by substr(process_time, 1, 8)) d, (SELECT sum(in_sum) a_rating_sum, round(avg(speed)) a_rating_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'rating'and SERVICE = 'gprs'and centre = 'A'group by substr(process_time, 1, 8)) a1, (SELECT sum(in_sum) b_rating_sum, round(avg(speed)) b_rating_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'rating'and SERVICE = 'gprs'and centre = 'B'group by substr(process_time, 1, 8)) b1, (SELECT sum(in_sum) c_rating_sum, round(avg(speed)) c_rating_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'rating'and SERVICE = 'gprs'and centre = 'C'group by substr(process_time, 1, 8)) c1, (SELECT sum(in_sum) d_rating_sum, round(avg(speed)) d_rating_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'rating'and SERVICE = 'gprs'and centre = 'D'group by substr(process_time, 1, 8)) d1"
            column_set: ["a_filter_sum","a_filter_speed","b_filter_sum","b_filter_speed","c_filter_sum","c_filter_speed","d_filter_sum","d_filter_speed","a_rating_sum","a_rating_speed","b_rating_sum","b_rating_speed","c_rating_sum","c_rating_speed","d_rating_sum","d_rating_speed"]
          - sql: "select a.a_addup_sum    a_addup_sum, a.a_addup_speed  a_addup_speed, b.b_addup_sum    b_addup_sum, b.b_addup_speed  b_addup_speed, c.c_addup_sum    c_addup_sum, c.c_addup_speed  c_addup_speed, d.d_addup_sum    d_addup_sum, d.d_addup_speed  d_addup_speed, a1.a_dupcheck_sum   a_dupcheck_sum, a1.a_dupcheck_speed a_dupcheck_speed, b1.b_dupcheck_sum   b_dupcheck_sum, b1.b_dupcheck_speed b_dupcheck_speed, c1.c_dupcheck_sum   c_dupcheck_sum, c1.c_dupcheck_speed c_dupcheck_speed, d1.d_dupcheck_sum   d_dupcheck_sum, d1.d_dupcheck_speed d_dupcheck_speed from (SELECT sum(in_sum) a_addup_sum, round(avg(speed)) a_addup_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'addup'and SERVICE = 'gprs'and centre = 'A'group by substr(process_time, 1, 8)) a, (SELECT sum(in_sum) b_addup_sum, round(avg(speed)) b_addup_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'addup'and SERVICE = 'gprs'and centre = 'B'group by substr(process_time, 1, 8)) b, (SELECT sum(in_sum) c_addup_sum, round(avg(speed)) c_addup_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'addup'and SERVICE = 'gprs'and centre = 'C'group by substr(process_time, 1, 8)) c, (SELECT sum(in_sum) d_addup_sum, round(avg(speed)) d_addup_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'addup'and SERVICE = 'gprs'and centre = 'D'group by substr(process_time, 1, 8)) d, (SELECT sum(in_sum) a_dupcheck_sum, round(avg(speed)) a_dupcheck_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'dupcheck'and SERVICE = 'gprs'and centre = 'A'group by substr(process_time, 1, 8)) a1, (SELECT sum(in_sum) b_dupcheck_sum, round(avg(speed)) b_dupcheck_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'dupcheck'and SERVICE = 'gprs'and centre = 'B'group by substr(process_time, 1, 8)) b1, (SELECT sum(in_sum) c_dupcheck_sum, round(avg(speed)) c_dupcheck_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'dupcheck'and SERVICE = 'gprs'and centre = 'C'group by substr(process_time, 1, 8)) c1, (SELECT sum(in_sum) d_dupcheck_sum, round(avg(speed)) d_dupcheck_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'dupcheck'and SERVICE = 'gprs'and centre = 'D'group by substr(process_time, 1, 8)) d1"
            column_set: ["a_addup_sum","a_addup_speed","b_addup_sum","b_addup_speed","c_addup_sum","c_addup_speed","d_addup_sum","d_addup_speed","a_dupcheck_sum","a_dupcheck_speed","b_dupcheck_sum","b_dupcheck_speed","c_dupcheck_sum","c_dupcheck_speed","d_dupcheck_sum","d_dupcheck_speed"]

  - series_name: cb_mdb_perf.1d
    desc: 计费mdb性能
    cron: "0 * * * *"
    runtime:
      interval: 86400
      update: true
      output_timestamp: "start:%Y%m%d"
    hosts:
      - adapter: oracle
        host: zjcba2.yw.zj.chinamobile.com
        port: 1521
        username: hp_dbspi
        password: hp_dbspi123
        database: zjcb2
        default_options:
          $beginmonth: "%Y%m"
          $begin: "%Y%m%d"
          $end: "%Y%m%d"
        sql_group:
          - sql: "select a.a_counts  a_jf_counts, a.a_speed   a_jf_speed, b.b_counts  b_jf_counts, b.b_speed   b_jf_speed, a1.a_counts a_user_counts, a1.a_speed  a_user_speed, b1.b_counts b_user_counts, b1.b_speed  b_user_speed, a2.a_counts a_addup_counts, a2.a_speed  a_addup_speed, b2.b_counts b_addup_counts, b2.b_speed  b_addup_speed from (SELECT sum(notify1_counts) a_counts, round(avg(notify1_average_time)) a_speed FROM (SELECT * FROM jfomc.mdb_kpi_jf_monitor_$beginmonth) where to_char(time, 'yyyymmdd') >= '$begin'and to_char(time, 'yyyymmdd') < '$end'and notify1_average_time between 1 and 10000 and host_name = 'ZJJACB16'group by to_char(time, 'yyyymmdd')) a, (SELECT sum(notify1_counts) b_counts, round(avg(notify1_average_time)) b_speed FROM (SELECT * FROM jfomc.mdb_kpi_jf_monitor_$beginmonth) where to_char(time, 'yyyymmdd') >= '$begin'and to_char(time, 'yyyymmdd') < '$end'and notify1_average_time between 1 and 10000 and host_name = 'ZJDACB16'group by to_char(time, 'yyyymmdd')) b, (SELECT sum(notify1_counts) a_counts, round(avg(notify1_average_time)) a_speed FROM (SELECT * FROM jfomc.mdb_kpi_user_monitor_$beginmonth) where to_char(time, 'yyyymmdd') >= '$begin'and to_char(time, 'yyyymmdd') < '$end'and notify1_average_time between 1 and 10000 and host_name = 'ZJJACB15'group by to_char(time, 'yyyymmdd')) a1, (SELECT sum(notify1_counts) b_counts, round(avg(notify1_average_time)) b_speed FROM (SELECT * FROM jfomc.mdb_kpi_user_monitor_$beginmonth) where to_char(time, 'yyyymmdd') >= '$begin'and to_char(time, 'yyyymmdd') < '$end'and notify1_average_time between 1 and 10000 and host_name = 'ZJDACB15'group by to_char(time, 'yyyymmdd')) b1, (SELECT sum(notify1_counts) a_counts, round(avg(notify1_average_time)) a_speed FROM jfomc.mdb_kpi_addup_monitor_$beginmonth where to_char(time, 'yyyymmdd') >= '$begin'and to_char(time, 'yyyymmdd') < '$end'and notify1_average_time between 1 and 10000 and host_name = 'ZJJACB18'group by to_char(time, 'yyyymmdd')) a2, (SELECT sum(notify1_counts) b_counts, round(avg(notify1_average_time)) b_speed FROM jfomc.mdb_kpi_addup_monitor_$beginmonth where to_char(time, 'yyyymmdd') >= '$begin'and to_char(time, 'yyyymmdd') < '$end'and notify1_average_time between 1 and 10000 and host_name = 'ZJDACB18'group by to_char(time, 'yyyymmdd')) b2"
            column_set: ["a_jf_counts","a_jf_speed","b_jf_counts","b_jf_speed","a_user_counts","a_user_speed","b_user_counts","b_user_speed","a_addup_counts","a_addup_speed","b_addup_counts","b_addup_speed"]
          - sql: "select a.conn_num  a_user_conn, b.conn_num  b_user_conn, a1.conn_num a_jf_conn, b1.conn_num b_jf_conn, a2.conn_num a_addup_conn, b2.conn_num b_addup_conn from (SELECT max(handle_num) conn_num FROM jfomc.mdb_kpi_user_monitor_$beginmonth where host_name = 'ZJJACB15'and to_char(time, 'yyyymmdd') >= '$begin'and to_char(time, 'yyyymmdd') < '$end'group by to_char(time, 'yyyymmdd')) a, (SELECT max(handle_num) conn_num FROM jfomc.mdb_kpi_user_monitor_$beginmonth where host_name = 'ZJDACB15'and to_char(time, 'yyyymmdd') >= '$begin'and to_char(time, 'yyyymmdd') < '$end'group by to_char(time, 'yyyymmdd')) b, (SELECT max(handle_num) conn_num FROM jfomc.mdb_kpi_jf_monitor_$beginmonth where host_name = 'ZJJACB16'and to_char(time, 'yyyymmdd') >= '$begin'and to_char(time, 'yyyymmdd') < '$end'group by to_char(time, 'yyyymmdd')) a1, (SELECT max(handle_num) conn_num FROM jfomc.mdb_kpi_jf_monitor_$beginmonth where host_name = 'ZJDACB16'and to_char(time, 'yyyymmdd') >= '$begin'and to_char(time, 'yyyymmdd') < '$end'group by to_char(time, 'yyyymmdd')) b1, (SELECT max(handle_num) conn_num FROM jfomc.mdb_kpi_addup_monitor_$beginmonth where host_name = 'ZJJACB18'and to_char(time, 'yyyymmdd') >= '$begin'and to_char(time, 'yyyymmdd') < '$end'group by to_char(time, 'yyyymmdd')) a2, (SELECT max(handle_num) conn_num FROM jfomc.mdb_kpi_addup_monitor_$beginmonth where host_name = 'ZJDACB18'and to_char(time, 'yyyymmdd') >= '$begin'and to_char(time, 'yyyymmdd') < '$end'group by to_char(time, 'yyyymmdd')) b2"
            column_set: ["a_user_conn","b_user_conn","a_jf_conn","b_jf_conn","a_addup_conn","b_addup_conn"]


  - series_name: cb_gprs_perf.10m
    desc: 计费GRPS实时性能
    cron: "0,10,20,30,40,50 * * * *"
    runtime:
      interval: 600
      delay_time: 1200
      output_timestamp: "start:%Y%m%d%H%M"
    hosts:
      - adapter: oracle
        host: zjcba2.yw.zj.chinamobile.com
        port: 1521
        username: hp_dbspi
        password: hp_dbspi123
        database: zjcb2
        default_options:
          $beginday: "%Y%m%d"
          $begin: "%Y%m%d%H%M"
          $end: "%Y%m%d%H%M"
        sql_group:
          - sql: "select /*+ parallel(5) */ a1.rating a_rating, a2.dup    a_dup, a3.filter a_filter, a4.addup  a_addup, b1.rating b_rating, b2.dup    b_dup, b3.filter b_filter, b4.addup  b_addup, c1.rating c_rating, c2.dup    c_dup, c3.filter c_filter, c4.addup  c_addup, d1.rating d_rating, d2.dup    d_dup, d3.filter d_filter, d4.addup  d_addup from (select count(*) rating from jfomc.sm_stat_input_$beginday a where file_path like '%rating%ggprs%'and file_name LIKE '%A'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') a1, (SELECT count(*) dup FROM jfomc.sm_stat_input_$beginday a where file_path like '%dupcheck%ggprs%'and file_name LIKE '%A'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') a2, (SELECT count(*) filter FROM jfomc.sm_stat_input_$beginday a where file_path like '%filter%ggprs%'and file_name LIKE '%A'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') a3, (SELECT count(*) addup FROM jfomc.sm_stat_input_$beginday a where file_path like '%addup%ggprs%'and file_name LIKE '%A'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') a4, (select count(*) rating from jfomc.sm_stat_input_$beginday a where file_path like '%rating%ggprs%'and file_name LIKE '%B'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') b1, (SELECT count(*) dup FROM jfomc.sm_stat_input_$beginday a where file_path like '%dupcheck%ggprs%'and file_name LIKE '%B'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') b2, (SELECT count(*) filter FROM jfomc.sm_stat_input_$beginday a where file_path like '%filter%ggprs%'and file_name LIKE '%B'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') b3, (SELECT count(*) addup FROM jfomc.sm_stat_input_$beginday a where file_path like '%addup%ggprs%'and file_name LIKE '%B'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') b4, (select count(*) rating from jfomc.sm_stat_input_$beginday a where file_path like '%rating%ggprs%'and file_name LIKE '%C'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') c1, (SELECT count(*) dup FROM jfomc.sm_stat_input_$beginday a where file_path like '%dupcheck%ggprs%'and file_name LIKE '%C'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') c2, (SELECT count(*) filter FROM jfomc.sm_stat_input_$beginday a where file_path like '%filter%ggprs%'and file_name LIKE '%C'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') c3, (SELECT count(*) addup FROM jfomc.sm_stat_input_$beginday a where file_path like '%addup%ggprs%'and file_name LIKE '%C'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') c4, (select count(*) rating from jfomc.sm_stat_input_$beginday a where file_path like '%rating%ggprs%'and file_name LIKE '%D'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') d1, (SELECT count(*) dup FROM jfomc.sm_stat_input_$beginday a where file_path like '%dupcheck%ggprs%'and file_name LIKE '%D'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') d2, (SELECT count(*) filter FROM jfomc.sm_stat_input_$beginday a where file_path like '%filter%ggprs%'and file_name LIKE '%D'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') d3, (SELECT count(*) addup FROM jfomc.sm_stat_input_$beginday a where file_path like '%addup%ggprs%'and file_name LIKE '%D'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') d4"
          - sql: "select count(1) gather_count from jf.monitor_jzcj_$beginday where src_ip = '10.254.48.6'and src_path_name not like '%SMS%'and deal_date >= to_date('$begin', 'yyyymmddhh24mi') and deal_date < to_date('$end', 'yyyymmddhh24mi')"
          - sql: "select count(1) proc_count from jf.monitor_task_$beginday where dup_count <> 0 and process_id in (select proc_id from jfsys.all_proc_def where proc_id like '1%'and error_path like '%ggprs%') and begin_time >= to_date('$begin', 'yyyymmddhh24mi') and begin_time < to_date('$end', 'yyyymmddhh24mi')"

  - series_name: cb_ggprs_report.1d
    desc: 计费GRPS业务收入数据
    cron: "0 * * * *"
    runtime:
      interval: 86400
      output_timestamp: "start:%Y%m%d"
      update: true
    hosts:
      - adapter: oracle
        host: zjcba2.yw.zj.chinamobile.com
        port: 1521
        username: hp_dbspi
        password: hp_dbspi123
        database: zjcb2
        default_options:
          $begin: "%Y%m%d"
          $end: "%Y%m%d"
        sql_group:
          - sql: "select a.audit_date, a.user_2G a_user_2g, a.user_3G a_user_3g, a.user_4G a_user_4g, a.count_2G a_count_2g, a.count_3G a_count_3g, a.count_4G a_count_4g, a.flow_2G a_flow_2g, a.flow_3G a_flow_3g, a.flow_4G a_flow_4g, a.cost_2G a_cost_2g, a.cost_3G a_cost_3g, a.cost_4G a_cost_4g, b.user_2G b_user_2g, b.user_3G b_user_3g, b.user_4G b_user_4g, b.count_2G b_count_2g, b.count_3G b_count_3g, b.count_4G b_count_4g, b.flow_2G b_flow_2g, b.flow_3G b_flow_3g, b.flow_4G b_flow_4g, b.cost_2G b_cost_2g, b.cost_3G b_cost_3g, b.cost_4G b_cost_4g from (select audit_date, sum(decode(module_id, 0, USERNUM)) user_2G, sum(decode(module_id, 1, USERNUM)) user_3G, sum(decode(module_id, 2, USERNUM)) user_4G, sum(decode(module_id, 0, CDRNUM)) count_2G, sum(decode(module_id, 1, CDRNUM)) count_3G, sum(decode(module_id, 2, CDRNUM)) count_4G, sum(decode(module_id, 0, volume / (1024 * 1024))) flow_2G, sum(decode(module_id, 1, volume / (1024 * 1024))) flow_3G, sum(decode(module_id, 2, volume / (1024 * 1024))) flow_4G, sum(decode(module_id, 0, charge / 1000)) cost_2G, sum(decode(module_id, 1, charge / 1000)) cost_3G, sum(decode(module_id, 2, charge / 1000)) cost_4G from jfa1.audit_ggprs_report where audit_date >= '$begin'and audit_date < '$end'and module_type = 'mns_type'and region in ('hz', 'hu') group by audit_date) a, (select audit_date, sum(decode(module_id, 0, USERNUM)) user_2G, sum(decode(module_id, 1, USERNUM)) user_3G, sum(decode(module_id, 2, USERNUM)) user_4G, sum(decode(module_id, 0, CDRNUM)) count_2G, sum(decode(module_id, 1, CDRNUM)) count_3G, sum(decode(module_id, 2, CDRNUM)) count_4G, sum(decode(module_id, 0, volume / (1024 * 1024))) flow_2G, sum(decode(module_id, 1, volume / (1024 * 1024))) flow_3G, sum(decode(module_id, 2, volume / (1024 * 1024))) flow_4G, sum(decode(module_id, 0, charge / 1000)) cost_2G, sum(decode(module_id, 1, charge / 1000)) cost_3G, sum(decode(module_id, 2, charge / 1000)) cost_4G from jfa1.audit_ggprs_report where audit_date >= '$begin'and audit_date < '$end'and module_type = 'mns_type'and region in ('sx', 'jx' ， 'tz') group by audit_date) b where a.audit_date = b.audit_date"

      - adapter: oracle
        host: zjcbb1.yw.zj.chinamobile.com
        port: 1521
        username: hp_dbspi
        password: hp_dbspi123
        database: zjcb1
        default_options:
          $begin: "%Y%m%d"
          $end: "%Y%m%d"
        sql_group:
          - sql: "select a.audit_date, a.user_2G c_user_2g, a.user_3G c_user_3g, a.user_4G c_user_4g, a.count_2G c_count_2g, a.count_3G c_count_3g, a.count_4G c_count_4g, a.flow_2G c_flow_2g, a.flow_3G c_flow_3g, a.flow_4G c_flow_4g, a.cost_2G c_cost_2g, a.cost_3G c_cost_3g, a.cost_4G c_cost_4g, b.user_2G d_user_2g, b.user_3G d_user_3g, b.user_4G d_user_4g, b.count_2G d_count_2g, b.count_3G d_count_3g, b.count_4G d_count_4g, b.flow_2G d_flow_2g, b.flow_3G d_flow_3g, b.flow_4G d_flow_4g, b.cost_2G d_cost_2g, b.cost_3G d_cost_3g, b.cost_4G d_cost_4g from (select audit_date, sum(decode(module_id, 0, USERNUM)) user_2G, sum(decode(module_id, 1, USERNUM)) user_3G, sum(decode(module_id, 2, USERNUM)) user_4G, sum(decode(module_id, 0, CDRNUM)) count_2G, sum(decode(module_id, 1, CDRNUM)) count_3G, sum(decode(module_id, 2, CDRNUM)) count_4G, sum(decode(module_id, 0, volume / (1024 * 1024))) flow_2G, sum(decode(module_id, 1, volume / (1024 * 1024))) flow_3G, sum(decode(module_id, 2, volume / (1024 * 1024))) flow_4G, sum(decode(module_id, 0, charge / 1000)) cost_2G, sum(decode(module_id, 1, charge / 1000)) cost_3G, sum(decode(module_id, 2, charge / 1000)) cost_4G from jfa1.audit_ggprs_report where audit_date >= '$begin'and audit_date < '$end'and module_type = 'mns_type'and region in ('qz', 'nb' ， 'jh') group by audit_date) a, (select audit_date, sum(decode(module_id, 0, USERNUM)) user_2G, sum(decode(module_id, 1, USERNUM)) user_3G, sum(decode(module_id, 2, USERNUM)) user_4G, sum(decode(module_id, 0, CDRNUM)) count_2G, sum(decode(module_id, 1, CDRNUM)) count_3G, sum(decode(module_id, 2, CDRNUM)) count_4G, sum(decode(module_id, 0, volume / (1024 * 1024))) flow_2G, sum(decode(module_id, 1, volume / (1024 * 1024))) flow_3G, sum(decode(module_id, 2, volume / (1024 * 1024))) flow_4G, sum(decode(module_id, 0, charge / 1000)) cost_2G, sum(decode(module_id, 1, charge / 1000)) cost_3G, sum(decode(module_id, 2, charge / 1000)) cost_4G from jfa1.audit_ggprs_report where audit_date >= '$begin'and audit_date < '$end'and module_type = 'mns_type'and region in ('wz', 'ls' ， 'zs') group by audit_date) b where a.audit_date = b.audit_date"

  - series_name: cb_gprs_details.1d
    desc: 计费GRPS业务收入数据
    cron: "0 * * * *"
    runtime:
      interval: 86400
      output_timestamp: "start:%Y%m%d"
      update: true
    hosts:
      - adapter: oracle
        host: zjcba2.yw.zj.chinamobile.com
        port: 1521
        username: hp_dbspi
        password: hp_dbspi123
        database: zjcb2
        default_options:
          $begin: "%Y%m%d"
          $end: "%Y%m%d"
        sql_group:
          - sql: "select 'a_'||module_id module_id,sum(charge) / 1000 charge from jfa1.audit_ggprs_report where audit_date = '$begin'and module_type = 'item_code'and region in ('hz', 'hu') and module_id is not null group by audit_date,module_id union all select 'b_'||module_id module_id,sum(charge) / 1000 charge from jfa1.audit_ggprs_report where audit_date = '$begin'and module_type = 'item_code'and  region in ('jx','sx','tz') and module_id is not null group by audit_date,module_id"
            column_set: ["a_43020001","a_43020011","a_43020121","a_43020131","a_43020141","a_43020721","a_43020731","a_43020741","a_43030101","a_43024001","a_43024011","a_43024121","a_43024131","a_43024141","a_43024721","a_43024731","a_43024741","a_43034101","b_43020001","b_43020011","b_43020121","b_43020131","b_43020141","b_43020721","b_43020731","b_43020741","b_43030101","b_43024001","b_43024011","b_43024121","b_43024131","b_43024141","b_43024721","b_43024731","b_43024741","b_43034101"]
            custom_key_and_value_column:
              key: module_id
              value: charge

      - adapter: oracle
        host: zjcbb1.yw.zj.chinamobile.com
        port: 1521
        username: hp_dbspi
        password: hp_dbspi123
        database: zjcb1
        default_options:
          $begin: "%Y%m%d"
          $end: "%Y%m%d"
        sql_group:
          - sql: "select 'c_'||module_id module_id,sum(charge) / 1000 charge from jfa1.audit_ggprs_report where audit_date = '$begin'and module_type = 'item_code'and region in ('qz','nb','jh') and module_id is not null group by audit_date,module_id union all select 'd_'||module_id module_id,sum(charge) / 1000 charge from jfa1.audit_ggprs_report where audit_date = '$begin'and module_type = 'item_code'and  region in ('wz','ls','zs') and module_id is not null group by audit_date,module_id"
            column_set: ["c_43020001","c_43020011","c_43020121","c_43020131","c_43020141","c_43020721","c_43020731","c_43020741","c_43030101","c_43024001","c_43024011","c_43024121","c_43024131","c_43024141","c_43024721","c_43024731","c_43024741","c_43034101","d_43020001","d_43020011","d_43020121","d_43020131","d_43020141","d_43020721","d_43020731","d_43020741","d_43030101","d_43024001","d_43024011","d_43024121","d_43024131","d_43024141","d_43024721","d_43024731","d_43024741","d_43034101"]
            custom_key_and_value_column:
              key: module_id
              value: charge

  - series_name: cb_qf_ocs.10m
    desc: OCS前置机异常
    cron: "0,10,20,30,40,50 * * * *"
    runtime:
      interval: 600
      delay_time: 3000
      output_timestamp: "start:%Y%m%d%H%M"
    hosts:
      - adapter: oracle
        host: 10.70.242.179
        port: 1521
        username: aiqf
        password: aiqf
        database: zjqf1
        default_options:
          $beginmonth: "%Y%m"
          $begin: "%Y%m%d%H%M"
          $end: "%Y%m%d%H%M"
        sql_group:
          - sql: "select sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf12' then e_session_full end) sess_zjdaqf12, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf13' then e_session_full end) sess_zjdaqf13, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf14' then e_session_full end) sess_zjdaqf14, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf22' then e_session_full end) sess_zjdaqf22, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf23' then e_session_full end) sess_zjdaqf23, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf24' then e_session_full end) sess_zjdaqf24, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf31' then e_session_full end) sess_zjdaqf31, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf32' then e_session_full end) sess_zjdaqf32, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf33' then e_session_full end) sess_zjdaqf33, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf34' then e_session_full end) sess_zjdaqf34, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf35' then e_session_full end) sess_zjdaqf35, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf36' then e_session_full end) sess_zjdaqf36, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf12' then e_session_full end) sess_zjjaqf12, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf13' then e_session_full end) sess_zjjaqf13, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf14' then e_session_full end) sess_zjjaqf14, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf22' then e_session_full end) sess_zjjaqf22, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf23' then e_session_full end) sess_zjjaqf23, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf24' then e_session_full end) sess_zjjaqf24, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf31' then e_session_full end) sess_zjjaqf31, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf32' then e_session_full end) sess_zjjaqf32, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf33' then e_session_full end) sess_zjjaqf33, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf34' then e_session_full end) sess_zjjaqf34, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf35' then e_session_full end) sess_zjjaqf35, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf36' then e_session_full end) sess_zjjaqf36 FROM aiqf.inbossd_kpi_gprs_$beginmonth where time >= to_date('$begin', 'yyyymmddhh24mi') and time < to_date('$end', 'yyyymmddhh24mi')"
            column_set: ["sess_zjdaqf12","sess_zjdaqf13","sess_zjdaqf14","sess_zjdaqf22","sess_zjdaqf23","sess_zjdaqf24","sess_zjdaqf31","sess_zjdaqf32","sess_zjdaqf33","sess_zjdaqf34","sess_zjdaqf35","sess_zjdaqf36","sess_zjjaqf12","sess_zjjaqf13","sess_zjjaqf14","sess_zjjaqf22","sess_zjjaqf23","sess_zjjaqf24","sess_zjjaqf31","sess_zjjaqf32","sess_zjjaqf33","sess_zjjaqf34","sess_zjjaqf35","sess_zjjaqf36"]
          - sql: "SELECT sum(CASE  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf12' then e_buf_full end)  buf_zjdaqf12, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf13' then e_buf_full end)  buf_zjdaqf13, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf14' then e_buf_full end)  buf_zjdaqf14, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf22' then e_buf_full end)  buf_zjdaqf22, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf23' then e_buf_full end)  buf_zjdaqf23, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf24' then e_buf_full end)  buf_zjdaqf24, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf31' then e_buf_full end)  buf_zjdaqf31, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf32' then e_buf_full end)  buf_zjdaqf32, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf33' then e_buf_full end)  buf_zjdaqf33, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf34' then e_buf_full end)  buf_zjdaqf34, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf35' then e_buf_full end)  buf_zjdaqf35, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf36' then e_buf_full end)  buf_zjdaqf36, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf12' then e_buf_full end)  buf_zjjaqf12, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf13' then e_buf_full end)  buf_zjjaqf13, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf14' then e_buf_full end)  buf_zjjaqf14, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf22' then e_buf_full end)  buf_zjjaqf22, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf23' then e_buf_full end)  buf_zjjaqf23, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf24' then e_buf_full end)  buf_zjjaqf24, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf31' then e_buf_full end)  buf_zjjaqf31, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf32' then e_buf_full end)  buf_zjjaqf32, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf33' then e_buf_full end)  buf_zjjaqf33, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf34' then e_buf_full end)  buf_zjjaqf34, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf35' then e_buf_full end)  buf_zjjaqf35, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf36' then e_buf_full end)  buf_zjjaqf36 FROM aiqf.inbossd_kpi_gprs_$beginmonth where time >= to_date('$begin', 'yyyymmddhh24mi') and time < to_date('$end', 'yyyymmddhh24mi')"
            column_set: ["buf_zjdaqf12","buf_zjdaqf13","buf_zjdaqf14","buf_zjdaqf22","buf_zjdaqf23","buf_zjdaqf24","buf_zjdaqf31","buf_zjdaqf32","buf_zjdaqf33","buf_zjdaqf34","buf_zjdaqf35","buf_zjdaqf36","buf_zjjaqf12","buf_zjjaqf13","buf_zjjaqf14","buf_zjjaqf22","buf_zjjaqf23","buf_zjjaqf24","buf_zjjaqf31","buf_zjjaqf32","buf_zjjaqf33","buf_zjjaqf34","buf_zjjaqf35","buf_zjjaqf36"]
          - sql: "select sum(CASE  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf12' then e_boss_timeout end)  timeout_zjdaqf12, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf13' then e_boss_timeout end)  timeout_zjdaqf13, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf14' then e_boss_timeout end)  timeout_zjdaqf14, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf22' then e_boss_timeout end)  timeout_zjdaqf22, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf23' then e_boss_timeout end)  timeout_zjdaqf23, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf24' then e_boss_timeout end)  timeout_zjdaqf24, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf31' then e_boss_timeout end)  timeout_zjdaqf31, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf32' then e_boss_timeout end)  timeout_zjdaqf32, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf33' then e_boss_timeout end)  timeout_zjdaqf33, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf34' then e_boss_timeout end)  timeout_zjdaqf34, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf35' then e_boss_timeout end)  timeout_zjdaqf35, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjdaqf36' then e_boss_timeout end)  timeout_zjdaqf36, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf12' then e_boss_timeout end)  timeout_zjjaqf12, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf13' then e_boss_timeout end)  timeout_zjjaqf13, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf14' then e_boss_timeout end)  timeout_zjjaqf14, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf22' then e_boss_timeout end)  timeout_zjjaqf22, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf23' then e_boss_timeout end)  timeout_zjjaqf23, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf24' then e_boss_timeout end)  timeout_zjjaqf24, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf31' then e_boss_timeout end)  timeout_zjjaqf31, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf32' then e_boss_timeout end)  timeout_zjjaqf32, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf33' then e_boss_timeout end)  timeout_zjjaqf33, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf34' then e_boss_timeout end)  timeout_zjjaqf34, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf35' then e_boss_timeout end)  timeout_zjjaqf35, sum(case  WHEN  substr(kpi_id, 1, 16) = 'inbossd_zjjaqf36' then e_boss_timeout end)  timeout_zjjaqf36 FROM aiqf.inbossd_kpi_gprs_$beginmonth where time >= to_date('$begin', 'yyyymmddhh24mi') and time < to_date('$end', 'yyyymmddhh24mi')"
            column_set: ["timeout_zjdaqf12","timeout_zjdaqf13","timeout_zjdaqf14","timeout_zjdaqf22","timeout_zjdaqf23","timeout_zjdaqf24","timeout_zjdaqf31","timeout_zjdaqf32","timeout_zjdaqf33","timeout_zjdaqf34","timeout_zjdaqf35","timeout_zjdaqf36","timeout_zjjaqf12","timeout_zjjaqf13","timeout_zjjaqf14","timeout_zjjaqf22","timeout_zjjaqf23","timeout_zjjaqf24","timeout_zjjaqf31","timeout_zjjaqf32","timeout_zjjaqf33","timeout_zjjaqf34","timeout_zjjaqf35","timeout_zjjaqf36"]
          - sql: "select sum(CASE WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf12' then e_RE_ASK end) ask_zjdaqf12, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf13' then e_RE_ASK end) ask_zjdaqf13, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf14' then e_RE_ASK end) ask_zjdaqf14, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf22' then e_RE_ASK end) ask_zjdaqf22, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf23' then e_RE_ASK end) ask_zjdaqf23, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf24' then e_RE_ASK end) ask_zjdaqf24, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf31' then e_RE_ASK end) ask_zjdaqf31, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf32' then e_RE_ASK end) ask_zjdaqf32, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf33' then e_RE_ASK end) ask_zjdaqf33, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf34' then e_RE_ASK end) ask_zjdaqf34, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf35' then e_RE_ASK end) ask_zjdaqf35, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjdaqf36' then e_RE_ASK end) ask_zjdaqf36, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf12' then e_RE_ASK end) ask_zjjaqf12, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf13' then e_RE_ASK end) ask_zjjaqf13, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf14' then e_RE_ASK end) ask_zjjaqf14, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf22' then e_RE_ASK end) ask_zjjaqf22, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf23' then e_RE_ASK end) ask_zjjaqf23, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf24' then e_RE_ASK end) ask_zjjaqf24, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf31' then e_RE_ASK end) ask_zjjaqf31, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf32' then e_RE_ASK end) ask_zjjaqf32, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf33' then e_RE_ASK end) ask_zjjaqf33, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf34' then e_RE_ASK end) ask_zjjaqf34, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf35' then e_RE_ASK end) ask_zjjaqf35, sum(case WHEN substr(kpi_id, 1, 16) = 'inbossd_zjjaqf36' then e_RE_ASK end) ask_zjjaqf36 FROM aiqf.inbossd_kpi_gprs_$beginmonth where time >= to_date('$begin', 'yyyymmddhh24mi') and time < to_date('$end', 'yyyymmddhh24mi')"
            column_set: ["ask_zjdaqf12","ask_zjdaqf13","ask_zjdaqf14","ask_zjdaqf22","ask_zjdaqf23","ask_zjdaqf24","ask_zjdaqf31","ask_zjdaqf32","ask_zjdaqf33","ask_zjdaqf34","ask_zjdaqf35","ask_zjdaqf36","ask_zjjaqf12","ask_zjjaqf13","ask_zjjaqf14","ask_zjjaqf22","ask_zjjaqf23","ask_zjjaqf24","ask_zjjaqf31","ask_zjjaqf32","ask_zjjaqf33","ask_zjjaqf34","ask_zjjaqf35","ask_zjjaqf36"]

  - series_name: cb_ggprs_details.1d
    desc: 国际GRPS业务收入数据
    cron: "0 * * * *"
    runtime:
      interval: 86400
      output_timestamp: "start:%Y%m%d"
      update: true
    hosts:
      - adapter: oracle
        host: zjcba2.yw.zj.chinamobile.com
        port: 1521
        username: hp_dbspi
        password: hp_dbspi123
        database: zjcb2
        default_options:
          $begin: "%Y%m%d"
          $end: "%Y%m%d"
        sql_group:
          - sql: "select a.g_43025001, b.g_43025101, c.g_43025701 from (select sum(charge) / 1000 g_43025001 from jfa1.audit_gprs_report where module_type = 'item_code'and module_id in ('43025001') and audit_date >= '$begin'and audit_date < '$end') a, (select sum(charge) / 1000 g_43025101 from jfa1.audit_gprs_report where module_type = 'item_code'and module_id in ('43025101') and audit_date >= '$begin'and audit_date < '$end') b, (select sum(charge) / 1000 g_43025701 from jfa1.audit_gprs_report where module_type = 'item_code'and module_id in ('43025701') and audit_date >= '$begin'and audit_date < '$end') c"

  - series_name: cb_gprs_report.1d
    desc: GRPS国际漫游
    cron: "0 * * * *"
    runtime:
      interval: 86400
      output_timestamp: "start:%Y%m%d"
      update: true
    hosts:
      - adapter: oracle
        host: zjcba2.yw.zj.chinamobile.com
        port: 1521
        username: hp_dbspi
        password: hp_dbspi123
        database: zjcb2
        default_options:
          $begin: "%Y%m%d"
          $end: "%Y%m%d"
        sql_group:
          - sql: "select sum(decode(module_id,0,USERNUM)) g_user_2g, sum(decode(module_id,1,USERNUM)) g_user_3g, sum(decode(module_id,2,USERNUM)) g_user_4g, sum(decode(module_id,0,CDRNUM)) g_count_2g, sum(decode(module_id,1,CDRNUM)) g_count_3g, sum(decode(module_id,2,CDRNUM)) g_count_4g, sum(decode(module_id,0,volume/(1024*1024))) g_flow_2g, sum(decode(module_id,1,volume/(1024*1024))) g_flow_3g, sum(decode(module_id,2,volume/(1024*1024))) g_flow_4g, sum(decode(module_id,0,charge/1000)) g_cost_2g, sum(decode(module_id,1,charge/1000)) g_cost_3g, sum(decode(module_id,2,charge/1000)) g_cost_4g from jfa1.audit_gprs_report where audit_date >= '$begin'and audit_date < '$end'and module_type = 'mns_type'"

  - series_name: cb_gprs_file.10m
    desc: 计费GRPS待处理文件数
    cron: "8,18,28,38,48,58 * * * *"
    runtime:
      interval: 600
      delay_time: 480
      output_timestamp: "start:%Y%m%d%H%M"
    hosts:
      - adapter: oracle
        host: zjcba1.yw.zj.chinamobile.com
        port: 1521
        username: hp_dbspi
        password: hp_dbspi123
        database: zjcb1
        default_options:
          $begin: "%Y%m%d%H%M"
          $end: "%Y%m%d%H%M"
        sql_group:
          - sql: "select a.addup a_addup, b.filter a_filter, c.dep a_dep, d.rating a_rating from (SELECT sum(file_num) addup FROM jf.monitor_gprs_dir where dir_path LIKE '%addup/ggprs%'and user_name = 'ngapp11'and mon_time >= to_date('$begin', 'yyyymmddhh24mi') and mon_time < to_date('$end', 'yyyymmddhh24mi')) a, (SELECT sum(file_num) filter FROM jf.monitor_gprs_dir where dir_path LIKE '%filter/ggprs%'and user_name = 'ngapp11'and mon_time >= to_date('$begin', 'yyyymmddhh24mi') and mon_time < to_date('$end', 'yyyymmddhh24mi')) b, (SELECT sum(file_num) dep FROM jf.monitor_gprs_dir where dir_path LIKE '%dupcheck/ggprs%'and user_name = 'ngapp11'and mon_time >= to_date('$begin', 'yyyymmddhh24mi') and mon_time < to_date('$end', 'yyyymmddhh24mi')) c, (SELECT sum(file_num) rating FROM jf.monitor_gprs_dir where dir_path LIKE '%rating/ggprs/in%'and user_name = 'ngapp11'and mon_time >= to_date('$begin', 'yyyymmddhh24mi') and mon_time < to_date('$end', 'yyyymmddhh24mi')) d"
            column_set: ["a_addup","a_filter","a_dep","a_rating"]
          - sql: "select a.addup b_addup, b.filter b_filter, c.dep b_dep, d.rating b_rating from (SELECT sum(file_num) addup FROM jf.monitor_gprs_dir where dir_path LIKE '%addup/ggprs%'and user_name = 'ngapp91'and mon_time >= to_date('$begin', 'yyyymmddhh24mi') and mon_time < to_date('$end', 'yyyymmddhh24mi')) a, (SELECT sum(file_num) filter FROM jf.monitor_gprs_dir where dir_path LIKE '%filter/ggprs%'and user_name = 'ngapp91'and mon_time >= to_date('$begin', 'yyyymmddhh24mi') and mon_time < to_date('$end', 'yyyymmddhh24mi')) b, (SELECT sum(file_num) dep FROM jf.monitor_gprs_dir where dir_path LIKE '%dupcheck/ggprs%'and user_name = 'ngapp91'and mon_time >= to_date('$begin', 'yyyymmddhh24mi') and mon_time < to_date('$end', 'yyyymmddhh24mi')) c, (SELECT sum(file_num) rating FROM jf.monitor_gprs_dir where dir_path LIKE '%rating/ggprs/in%'and user_name = 'ngapp91'and mon_time >= to_date('$begin', 'yyyymmddhh24mi') and mon_time < to_date('$end', 'yyyymmddhh24mi')) d"
            column_set: ["b_addup","b_filter","b_dep","b_rating"]
          - sql: "select a.addup c_addup, b.filter c_filter, c.dep c_dep, d.rating c_rating from (SELECT sum(file_num) addup FROM jf.monitor_gprs_dir where dir_path LIKE '%addup/ggprs%'and user_name = 'ngapp12'and mon_time >= to_date('$begin', 'yyyymmddhh24mi') and mon_time < to_date('$end', 'yyyymmddhh24mi')) a, (SELECT sum(file_num) filter FROM jf.monitor_gprs_dir where dir_path LIKE '%filter/ggprs%'and user_name = 'ngapp12'and mon_time >= to_date('$begin', 'yyyymmddhh24mi') and mon_time < to_date('$end', 'yyyymmddhh24mi')) b, (SELECT sum(file_num) dep FROM jf.monitor_gprs_dir where dir_path LIKE '%dupcheck/ggprs%'and user_name = 'ngapp12'and mon_time >= to_date('$begin', 'yyyymmddhh24mi') and mon_time < to_date('$end', 'yyyymmddhh24mi')) c, (SELECT sum(file_num) rating FROM jf.monitor_gprs_dir where dir_path LIKE '%rating/ggprs/in%'and user_name = 'ngapp12'and mon_time >= to_date('$begin', 'yyyymmddhh24mi') and mon_time < to_date('$end', 'yyyymmddhh24mi')) d"
            column_set: ["c_addup","c_filter","c_dep","c_rating"]
          - sql: "select a.addup d_addup, b.filter d_filter, c.dep d_dep, d.rating d_rating from (SELECT sum(file_num) addup FROM jf.monitor_gprs_dir where dir_path LIKE '%addup/ggprs%'and user_name = 'ngapp92'and mon_time >= to_date('$begin', 'yyyymmddhh24mi') and mon_time < to_date('$end', 'yyyymmddhh24mi')) a, (SELECT sum(file_num) filter FROM jf.monitor_gprs_dir where dir_path LIKE '%filter/ggprs%'and user_name = 'ngapp92'and mon_time >= to_date('$begin', 'yyyymmddhh24mi') and mon_time < to_date('$end', 'yyyymmddhh24mi')) b, (SELECT sum(file_num) dep FROM jf.monitor_gprs_dir where dir_path LIKE '%dupcheck/ggprs%'and user_name = 'ngapp92'and mon_time >= to_date('$begin', 'yyyymmddhh24mi') and mon_time < to_date('$end', 'yyyymmddhh24mi')) c, (SELECT sum(file_num) rating FROM jf.monitor_gprs_dir where dir_path LIKE '%rating/ggprs/in%'and user_name = 'ngapp92'and mon_time >= to_date('$begin', 'yyyymmddhh24mi') and mon_time < to_date('$end', 'yyyymmddhh24mi')) d"
            column_set: ["d_addup","d_filter","d_dep","d_rating"]

  - series_name: cb_dccproxy_perf.10m
    desc: DCCProxy实时监控
    cron: "0,10,20,30,40,50 * * * *"
    runtime:
      interval: 600
      delay_time: 3600
      output_timestamp: "start:%Y%m%d%H%M"
    hosts:
      - adapter: oracle
        host: 10.70.242.179
        port: 1521
        username: aiqf
        password: aiqf
        database: zjqf1
        default_options:
          $beginmonth: "%Y%m"
          $begin: "%Y%m%d%H%M"
          $end: "%Y%m%d%H%M"
        sql_group:
          - sql: "select sum(case WHEN substr(kpi_id, 11, 8) = 'zjdaqf12' then CCR_local end) ccr_zjdaqf12, sum(case WHEN substr(kpi_id, 11, 8) = 'zjdaqf13' then CCR_local end) ccr_zjdaqf13, sum(case WHEN substr(kpi_id, 11, 8) = 'zjdaqf14' then CCR_local end) ccr_zjdaqf14, sum(case WHEN substr(kpi_id, 11, 8) = 'zjjaqf12' then CCR_local end) ccr_zjjaqf12, sum(case WHEN substr(kpi_id, 11, 8) = 'zjjaqf13' then CCR_local end) ccr_zjjaqf13, sum(case WHEN substr(kpi_id, 11, 8) = 'zjjaqf14' then CCR_local end) ccr_zjjaqf14 FROM aiqf.dcc_kpi_gprs_$beginmonth where time >= to_date('$begin','yyyymmddhh24mi') and time < to_date('$end','yyyymmddhh24mi')"
            column_set: ["ccr_zjdaqf12","ccr_zjdaqf13","ccr_zjdaqf14","ccr_zjjaqf12","ccr_zjjaqf13","ccr_zjjaqf14"]
          - sql: "select sum(case WHEN substr(kpi_id, 11, 8) = 'zjdaqf12' then CCA_LOCAL end) cca_zjdaqf12, sum(case WHEN substr(kpi_id, 11, 8) = 'zjdaqf13' then CCA_LOCAL end) cca_zjdaqf13, sum(case WHEN substr(kpi_id, 11, 8) = 'zjdaqf14' then CCA_LOCAL end) cca_zjdaqf14, sum(case WHEN substr(kpi_id, 11, 8) = 'zjjaqf12' then CCA_LOCAL end) cca_zjjaqf12, sum(case WHEN substr(kpi_id, 11, 8) = 'zjjaqf13' then CCA_LOCAL end) cca_zjjaqf13, sum(case WHEN substr(kpi_id, 11, 8) = 'zjjaqf14' then CCA_LOCAL end) cca_zjjaqf14 FROM aiqf.dcc_kpi_gprs_$beginmonth where time >= to_date('$begin','yyyymmddhh24mi') and time < to_date('$end','yyyymmddhh24mi')"
            column_set: ["cca_zjdaqf12","cca_zjdaqf13","cca_zjdaqf14","cca_zjjaqf12","cca_zjjaqf13","cca_zjjaqf14"]
          - sql: "select sum(case  WHEN  substr(kpi_id, 11, 8) = 'zjdaqf12' then round(CCR_LOCAL_FAIL/CCR_LOCAL,2) end)  ccrf_zjdaqf12, sum(case  WHEN  substr(kpi_id, 11, 8) = 'zjdaqf13' then round(CCR_LOCAL_FAIL/CCR_LOCAL,2) end)  ccrf_zjdaqf13, sum(case  WHEN  substr(kpi_id, 11, 8) = 'zjdaqf14' then round(CCR_LOCAL_FAIL/CCR_LOCAL,2) end)  ccrf_zjdaqf14, sum(case  WHEN  substr(kpi_id, 11, 8) = 'zjjaqf12' then round(CCR_LOCAL_FAIL/CCR_LOCAL,2) end)  ccrf_zjjaqf12, sum(case  WHEN  substr(kpi_id, 11, 8) = 'zjjaqf13' then round(CCR_LOCAL_FAIL/CCR_LOCAL,2) end)  ccrf_zjjaqf13, sum(case  WHEN  substr(kpi_id, 11, 8) = 'zjjaqf14' then round(CCR_LOCAL_FAIL/CCR_LOCAL,2) end)  ccrf_zjjaqf14 FROM aiqf.dcc_kpi_gprs_$beginmonth where CCR_LOCAL <> 0 and time >= to_date('$begin','yyyymmddhh24mi') and time < to_date('$end','yyyymmddhh24mi')"
            column_set: ["ccrf_zjdaqf12","ccrf_zjdaqf13","ccrf_zjdaqf14","ccrf_zjjaqf12","ccrf_zjjaqf13","ccrf_zjjaqf14"]
          - sql: "select sum(case  WHEN  substr(kpi_id, 11, 8) = 'zjdaqf12' then round(CCA_LOCAL_FAIL/CCA_LOCAL,2) end)  ccaf_zjdaqf12, sum(case  WHEN  substr(kpi_id, 11, 8) = 'zjdaqf13' then round(CCA_LOCAL_FAIL/CCA_LOCAL,2) end)  ccaf_zjdaqf13, sum(case  WHEN  substr(kpi_id, 11, 8) = 'zjdaqf14' then round(CCA_LOCAL_FAIL/CCA_LOCAL,2) end)  ccaf_zjdaqf14, sum(case  WHEN  substr(kpi_id, 11, 8) = 'zjjaqf12' then round(CCA_LOCAL_FAIL/CCA_LOCAL,2) end)  ccaf_zjjaqf12, sum(case  WHEN  substr(kpi_id, 11, 8) = 'zjjaqf13' then round(CCA_LOCAL_FAIL/CCA_LOCAL,2) end)  ccaf_zjjaqf13, sum(case  WHEN  substr(kpi_id, 11, 8) = 'zjjaqf14' then round(CCA_LOCAL_FAIL/CCA_LOCAL,2) end)  ccaf_zjjaqf14 FROM aiqf.dcc_kpi_gprs_$beginmonth where CCA_LOCAL <> 0 and time >= to_date('$begin','yyyymmddhh24mi') and time < to_date('$end','yyyymmddhh24mi')"
            column_set: ["ccaf_zjdaqf12","ccaf_zjdaqf13","ccaf_zjdaqf14","ccaf_zjjaqf12","ccaf_zjjaqf13","ccaf_zjjaqf14"]
          - sql: "select sum(case WHEN substr(kpi_id, 11, 8) = 'zjdaqf12' then round(CCA_ERROR/CCA_LOCAL,2) end) ccae_zjdaqf12, sum(case WHEN substr(kpi_id, 11, 8) = 'zjdaqf13' then round(CCA_ERROR/CCA_LOCAL,2) end) ccae_zjdaqf13, sum(case WHEN substr(kpi_id, 11, 8) = 'zjdaqf14' then round(CCA_ERROR/CCA_LOCAL,2) end) ccae_zjdaqf14, sum(case WHEN substr(kpi_id, 11, 8) = 'zjjaqf12' then round(CCA_ERROR/CCA_LOCAL,2) end) ccae_zjjaqf12, sum(case WHEN substr(kpi_id, 11, 8) = 'zjjaqf13' then round(CCA_ERROR/CCA_LOCAL,2) end) ccae_zjjaqf13, sum(case WHEN substr(kpi_id, 11, 8) = 'zjjaqf14' then round(CCA_ERROR/CCA_LOCAL,2) end) ccae_zjjaqf14 FROM aiqf.dcc_kpi_gprs_$beginmonth where CCA_LOCAL <> 0 and time >= to_date('$begin','yyyymmddhh24mi') and time < to_date('$end','yyyymmddhh24mi')"
            column_set: ["ccae_zjdaqf12","ccae_zjdaqf13","ccae_zjdaqf14","ccae_zjjaqf12","ccae_zjjaqf13","ccae_zjjaqf14"]

  - series_name: qry_perf.10m
    desc: 查询代理查询量和响应时长
    cron: "5,15,25,35,45,55 * * * *"
    runtime:
      interval: 600
      delay_time: 900
      output_timestamp: "start:%Y%m%d%H%M"
    hosts:
      - adapter: oracle
        host: zjcba2.yw.zj.chinamobile.com
        port: 1521
        username: hp_dbspi
        password: hp_dbspi123
        database: zjcba2
        default_options:
          $beginmonth: "%Y%m"
          $begin: "%Y%m%d%H%M"
          $end: "%Y%m%d%H%M"
        sql_group:
          - sql: "SELECT sum(notify1_counts) + sum(notify2_counts) + sum(notify3_counts) a_count, round(avg(notify1_average_time)) + round(avg(notify2_average_time)) + round(avg(notify3_average_time)) a_time FROM jfomc.mdb_kpi_qry_monitor_$beginmonth where host_name = 'ZJJACB16'and kpi_id = '25801'and time >= to_date('$begin','yyyymmddhh24mi') and  time < to_date('$end','yyyymmddhh24mi')"
            column_set: ["a_count","a_time"]
          - sql: "SELECT sum(notify1_counts) + sum(notify2_counts) + sum(notify3_counts) b_count, round(avg(notify1_average_time)) + round(avg(notify2_average_time)) + round(avg(notify3_average_time)) b_time FROM jfomc.mdb_kpi_qry_monitor_$beginmonth where host_name = 'ZJDACB16' and kpi_id = '25801'and time >= to_date('$begin','yyyymmddhh24mi') and  time < to_date('$end','yyyymmddhh24mi')"
            column_set: ["b_count","b_time"]
          - sql: "SELECT max(handle_num) a_maxconn FROM jfomc.mdb_kpi_qry_monitor_$beginmonth where host_name = 'ZJJACB16' and kpi_id = '25801' and time >= to_date('$begin', 'yyyymmddhh24mi') and time < to_date('$end', 'yyyymmddhh24mi')"
            column_set: ["a_maxconn"]
          - sql: "SELECT max(handle_num) b_maxconn FROM jfomc.mdb_kpi_qry_monitor_$beginmonth where host_name = 'ZJDACB16' and kpi_id = '25801' and time >= to_date('$begin', 'yyyymmddhh24mi') and time < to_date('$end', 'yyyymmddhh24mi')"
            column_set: ["b_maxconn"]
          - sql: "SELECT round(sum(NOTIFY1_SUCCESS_COUNTS)/sum(NOTIFY1_counts),4) a_free_succ, round(sum(NOTIFY3_SUCCESS_COUNTS)/sum(NOTIFY3_counts),4) a_addup_succ FROM jfomc.mdb_kpi_qry_monitor_$beginmonth where host_name = 'ZJJACB16' and kpi_id = '25801'and (NOTIFY1_counts >0  and NOTIFY3_counts >0) and time >= to_date('$begin', 'yyyymmddhh24mi') and time < to_date('$end', 'yyyymmddhh24mi')"
            column_set: ["a_free_succ","a_addup_succ"]
          - sql: "SELECT round(sum(NOTIFY1_SUCCESS_COUNTS)/sum(NOTIFY1_counts),4) b_free_succ, round(sum(NOTIFY3_SUCCESS_COUNTS)/sum(NOTIFY3_counts),4) b_addup_succ FROM jfomc.mdb_kpi_qry_monitor_$beginmonth where host_name = 'ZJDACB16' and kpi_id = '25801'and (NOTIFY1_counts >0  and NOTIFY3_counts >0) and time >= to_date('$begin', 'yyyymmddhh24mi') and time < to_date('$end', 'yyyymmddhh24mi')"
            column_set: ["b_free_succ","b_addup_succ"]

  - series_name: qry_zqtx_perf.10m
    desc: 周期提醒查询量和响应时长
    cron: "5,15,25,35,45,55 * * * *"
    runtime:
      interval: 600
      delay_time: 900
      output_timestamp: "start:%Y%m%d%H%M"
    hosts:
      - adapter: oracle
        host: zjcba2.yw.zj.chinamobile.com
        port: 1521
        username: hp_dbspi
        password: hp_dbspi123
        database: zjcba2
        default_options:
          $beginmonth: "%Y%m"
          $begin: "%Y%m%d%H%M"
          $end: "%Y%m%d%H%M"
        sql_group:
          - sql: "SELECT sum(notify1_counts) + sum(notify2_counts) + sum(notify3_counts) a_count, round(avg(notify1_average_time)) + round(avg(notify2_average_time)) + round(avg(notify3_average_time)) a_time FROM jfomc.mdb_kpi_qry_monitor_$beginmonth where host_name = 'ZJJACB16'and kpi_id = 'qry_zqtx'and time >= to_date('$begin','yyyymmddhh24mi') and  time < to_date('$end','yyyymmddhh24mi')"
            column_set: ["a_count","a_time"]
          - sql: "SELECT sum(notify1_counts) + sum(notify2_counts) + sum(notify3_counts) b_count, round(avg(notify1_average_time)) + round(avg(notify2_average_time)) + round(avg(notify3_average_time)) b_time FROM jfomc.mdb_kpi_qry_monitor_$beginmonth where host_name = 'ZJDACB16' and kpi_id = 'qry_zqtx'and time >= to_date('$begin','yyyymmddhh24mi') and  time < to_date('$end','yyyymmddhh24mi')"
            column_set: ["b_count","b_time"]
          - sql: "SELECT max(handle_num) a_maxconn FROM jfomc.mdb_kpi_qry_monitor_$beginmonth where host_name = 'ZJJACB16' and kpi_id = 'qry_zqtx' and time >= to_date('$begin', 'yyyymmddhh24mi') and time < to_date('$end', 'yyyymmddhh24mi')"
            column_set: ["a_maxconn"]
          - sql: "SELECT max(handle_num) b_maxconn FROM jfomc.mdb_kpi_qry_monitor_$beginmonth where host_name = 'ZJDACB16' and kpi_id = 'qry_zqtx' and time >= to_date('$begin', 'yyyymmddhh24mi') and time < to_date('$end', 'yyyymmddhh24mi')"
            column_set: ["b_maxconn"]
