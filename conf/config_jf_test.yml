output:
  - adapter: influxdb
    host: 10.70.181.211,127.0.0.1
    username: root
    password: 1qaz2wsx
    database: app_data

input:
  - series_name: cb_process_perf.1d
    desc: 计费分析批价性能
    cron: "* * * * *"
    runtime:
      interval: 86400   #sql select time interval
      delay_time: 1200
      output_timestamp: "start:%Y%m%d" #"end:%Y%m%d%H%M%S"
      update: true
    hosts:
      - adapter: "oracle"
        host: "zjcba1.yw.zj.chinamobile.com"
        port: 1521
        #version: "12c" #特殊数据库版本标记, jdbc链接方式
        username: "hp_dbspi"
        password: 'hp_dbspi123'
        database: "zjcb1"
        sql_group:
          - sql: "select a.a_filter_sum a_filter_sum, a.a_filter_speed a_filter_speed, b.b_filter_sum b_filter_sum, b.b_filter_speed b_filter_speed, c.c_filter_sum c_filter_sum, c.c_filter_speed c_filter_speed, d.d_filter_sum d_filter_sum, d.d_filter_speed d_filter_speed, a1.a_rating_sum a_rating_sum, a1.a_rating_speed a_rating_speed, b1.b_rating_sum b_rating_sum, b1.b_rating_speed b_rating_speed, c1.c_rating_sum c_rating_sum, c1.c_rating_speed c_rating_speed, d1.d_rating_sum d_rating_sum, d1.d_rating_speed d_rating_speed from (SELECT sum(in_sum) a_filter_sum, round(avg(speed)) a_filter_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'filter'and SERVICE = 'gprs'and centre = 'A'group by substr(process_time, 1, 8)) a, (SELECT sum(in_sum) b_filter_sum, round(avg(speed)) b_filter_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'filter'and SERVICE = 'gprs'and centre = 'B'group by substr(process_time, 1, 8)) b, (SELECT sum(in_sum) c_filter_sum, round(avg(speed)) c_filter_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'filter'and SERVICE = 'gprs'and centre = 'C'group by substr(process_time, 1, 8)) c, (SELECT sum(in_sum) d_filter_sum, round(avg(speed)) d_filter_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'filter'and SERVICE = 'gprs'and centre = 'D'group by substr(process_time, 1, 8)) d, (SELECT sum(in_sum) a_rating_sum, round(avg(speed)) a_rating_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'rating'and SERVICE = 'gprs'and centre = 'A'group by substr(process_time, 1, 8)) a1, (SELECT sum(in_sum) b_rating_sum, round(avg(speed)) b_rating_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'rating'and SERVICE = 'gprs'and centre = 'B'group by substr(process_time, 1, 8)) b1, (SELECT sum(in_sum) c_rating_sum, round(avg(speed)) c_rating_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'rating'and SERVICE = 'gprs'and centre = 'C'group by substr(process_time, 1, 8)) c1, (SELECT sum(in_sum) d_rating_sum, round(avg(speed)) d_rating_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'rating'and SERVICE = 'gprs'and centre = 'D'group by substr(process_time, 1, 8)) d1"
            custom_key_and_value_column:
              key: column1
              value: column2
            column_set: ["a_filter_sum","a_filter_speed","b_filter_sum","b_filter_speed","c_filter_sum","c_filter_speed","d_filter_sum","d_filter_speed","a_rating_sum","a_rating_speed","b_rating_sum","b_rating_speed","c_rating_sum","c_rating_speed","d_rating_sum","d_rating_speed"]
            options:
              $beginmonth: "%Y%m"
              $beginday: "%Y%m%d"
              $begin: "%Y%m%d"
              $end: "%Y%m%d"
          - sql: "select a.a_addup_sum    a_addup_sum, a.a_addup_speed  a_addup_speed, b.b_addup_sum    b_addup_sum, b.b_addup_speed  b_addup_speed, c.c_addup_sum    c_addup_sum, c.c_addup_speed  c_addup_speed, d.d_addup_sum    d_addup_sum, d.d_addup_speed  d_addup_speed, a1.a_dupcheck_sum   a_dupcheck_sum, a1.a_dupcheck_speed a_dupcheck_speed, b1.b_dupcheck_sum   b_dupcheck_sum, b1.b_dupcheck_speed b_dupcheck_speed, c1.c_dupcheck_sum   c_dupcheck_sum, c1.c_dupcheck_speed c_dupcheck_speed, d1.d_dupcheck_sum   d_dupcheck_sum, d1.d_dupcheck_speed d_dupcheck_speed from (SELECT sum(in_sum) a_addup_sum, round(avg(speed)) a_addup_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'addup'and SERVICE = 'gprs'and centre = 'A'group by substr(process_time, 1, 8)) a, (SELECT sum(in_sum) b_addup_sum, round(avg(speed)) b_addup_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'addup'and SERVICE = 'gprs'and centre = 'B'group by substr(process_time, 1, 8)) b, (SELECT sum(in_sum) c_addup_sum, round(avg(speed)) c_addup_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'addup'and SERVICE = 'gprs'and centre = 'C'group by substr(process_time, 1, 8)) c, (SELECT sum(in_sum) d_addup_sum, round(avg(speed)) d_addup_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'addup'and SERVICE = 'gprs'and centre = 'D'group by substr(process_time, 1, 8)) d, (SELECT sum(in_sum) a_dupcheck_sum, round(avg(speed)) a_dupcheck_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'dupcheck'and SERVICE = 'gprs'and centre = 'A'group by substr(process_time, 1, 8)) a1, (SELECT sum(in_sum) b_dupcheck_sum, round(avg(speed)) b_dupcheck_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'dupcheck'and SERVICE = 'gprs'and centre = 'B'group by substr(process_time, 1, 8)) b1, (SELECT sum(in_sum) c_dupcheck_sum, round(avg(speed)) c_dupcheck_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'dupcheck'and SERVICE = 'gprs'and centre = 'C'group by substr(process_time, 1, 8)) c1, (SELECT sum(in_sum) d_dupcheck_sum, round(avg(speed)) d_dupcheck_speed FROM jfa1.monitor_efficiency_t where substr(process_time, 1, 8) >= '$begin'AND substr(process_time, 1, 8) < '$end'and module_type = 'dupcheck'and SERVICE = 'gprs'and centre = 'D'group by substr(process_time, 1, 8)) d1"
            column_set: ["a_addup_sum","a_addup_speed","b_addup_sum","b_addup_speed","c_addup_sum","c_addup_speed","d_addup_sum","d_addup_speed","a_dupcheck_sum","a_dupcheck_speed","b_dupcheck_sum","b_dupcheck_speed","c_dupcheck_sum","c_dupcheck_speed","d_dupcheck_sum","d_dupcheck_speed"]
            options:
              $beginmonth: "%Y%m"
              $beginday: "%Y%m%d"
              $begin: "%Y%m%d"
              $end: "%Y%m%d"

  - series_name: 'cb_gprs_perf.10m'
    desc: "计费GRPS实时性能"
    cron: "0,10,20,30,40,50 * * * *"
    runtime:
      interval: 600
      delay_time: 1200
      output_timestamp: "end:%Y%m%d%H%M"
    hosts:
      - adapter: "oracle"
        host: "zjcba1.yw.zj.chinamobile.com"
        port: 1521
        username: "hp_dbspi"
        password: 'hp_dbspi123'
        database: "zjcb1"
        default_options:
          $beginmonth: "%Y%m"
          $beginday: "%Y%m%d"
          $begin: "%Y%m%d%H%M"
          $end: "%Y%m%d%H%M"
        sql_group:
          - sql: "select a1.rating a_rating, a2.dup    a_dup, a3.filter a_filter, a4.addup  a_addup, b1.rating b_rating, b2.dup    b_dup, b3.filter b_filter, b4.addup  b_addup, c1.rating c_rating, c2.dup    c_dup, c3.filter c_filter, c4.addup  c_addup, d1.rating d_rating, d2.dup    d_dup, d3.filter d_filter, d4.addup  d_addup from (select count(*) rating from jfomc.sm_stat_input_$beginday a where file_path like '%rating%ggprs%'and file_name LIKE '%A'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') a1, (SELECT count(*) dup FROM jfomc.sm_stat_input_$beginday a where file_path like '%dupcheck%ggprs%'and file_name LIKE '%A'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') a2, (SELECT count(*) filter FROM jfomc.sm_stat_input_$beginday a where file_path like '%filter%ggprs%'and file_name LIKE '%A'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') a3, (SELECT count(*) addup FROM jfomc.sm_stat_input_$beginday a where file_path like '%addup%ggprs%'and file_name LIKE '%A'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') a4, (select count(*) rating from jfomc.sm_stat_input_$beginday a where file_path like '%rating%ggprs%'and file_name LIKE '%B'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') b1, (SELECT count(*) dup FROM jfomc.sm_stat_input_$beginday a where file_path like '%dupcheck%ggprs%'and file_name LIKE '%B'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') b2, (SELECT count(*) filter FROM jfomc.sm_stat_input_$beginday a where file_path like '%filter%ggprs%'and file_name LIKE '%B'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') b3, (SELECT count(*) addup FROM jfomc.sm_stat_input_$beginday a where file_path like '%addup%ggprs%'and file_name LIKE '%B'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') b4, (select count(*) rating from jfomc.sm_stat_input_$beginday a where file_path like '%rating%ggprs%'and file_name LIKE '%C'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') c1, (SELECT count(*) dup FROM jfomc.sm_stat_input_$beginday a where file_path like '%dupcheck%ggprs%'and file_name LIKE '%C'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') c2, (SELECT count(*) filter FROM jfomc.sm_stat_input_$beginday a where file_path like '%filter%ggprs%'and file_name LIKE '%C'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') c3, (SELECT count(*) addup FROM jfomc.sm_stat_input_$beginday a where file_path like '%addup%ggprs%'and file_name LIKE '%C'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') c4, (select count(*) rating from jfomc.sm_stat_input_$beginday a where file_path like '%rating%ggprs%'and file_name LIKE '%D'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') d1, (SELECT count(*) dup FROM jfomc.sm_stat_input_$beginday a where file_path like '%dupcheck%ggprs%'and file_name LIKE '%D'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') d2, (SELECT count(*) filter FROM jfomc.sm_stat_input_$beginday a where file_path like '%filter%ggprs%'and file_name LIKE '%D'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') d3, (SELECT count(*) addup FROM jfomc.sm_stat_input_$beginday a where file_path like '%addup%ggprs%'and file_name LIKE '%D'and substr(tache_stop_time, 1, 12) >= '$begin'and substr(tache_stop_time, 1, 12) < '$end') d4"
          - sql: "select count(1) gather_count from jf.monitor_jzcj_$beginday where src_ip = '10.254.48.6'and src_path_name not like '%SMS%'and deal_date >= to_date('$begin', 'yyyymmddhh24mi') and deal_date < to_date('$end', 'yyyymmddhh24mi')"
            options:
              $beginmonth: "%Y%m"
              $beginday: "%Y%m%d"
              $begin: "%Y%m%d%H%M"
              $end: "%Y%m%d%H%M"
          - sql: "select count(1) proc_count from jf.monitor_task_$beginday where dup_count <> 0 and process_id in (select proc_id from jfsys.all_proc_def where proc_id like '1%'and error_path like '%ggprs%') and begin_time >= to_date('$begin', 'yyyymmddhh24mi') and begin_time < to_date('$end', 'yyyymmddhh24mi')"
